The Game Attendance Report Module automates the generation of attendance data for Games sessions based on soldier duty assignments, ranks, company structure, and excusal conditions.
It provides both analytical summaries and tabular breakdowns in Excel (.xlsx) and PDF formats for download or sharing.

To generate accurate Game Attendance Summaries based on daily  inputs.
To automatically exclude excused soldiers from the attendance list according to duty, leave, training, or other commitments.
To export reports in Excel and PDF formats following standardized layouts (Format 1 & Format 2)


Format 1 – Summary by Company and Rank type
==================
Column	Description
Company	Company name (A, B, C, D, E) it will be dynamic from company table
Rank Types	Grouped list of ranks type within the company
Total	Total number of soldiers in that rank/company
Excused	Number of soldiers excused (due to duty, training, etc.)
All Total	Combined total of all rank and excused soldiers

example:

Company | Rank type 1 | Rank type 2 | Rank  type 3 | Total | Excused | All Total
A       | 1       | 3      | 2      | 6     | 1       | 7
B       | 2      | 0      | 2      | 4     | 2       | 6
C       | 3      | 1      | 0      | 4     | 3       | 7
-------------------------------------------
Total   | 15     | 10     | 4      | 29    | 12      | 41




Format 2 – Exclusion by Duty / Appointment Type
===============
Displays soldiers excluded from Game attendance based on assignment type and status.

Section	Sub-item	Description
Roster Duties	Duty name	Number of soldiers on roster duty
Fixed Duties	Duty name	Number of soldiers on fixed duty
Appointments	Appointment name	Number of soldiers with active appointments
Training/Courses	Course/Cadre name	Number of soldiers currently training
Leave	Leave name	Number of soldiers on leave

                A     B     C     D     E     Total
---------------------------------------------------
 duty name      1     2     0     3     2       8
  -Guard Duty   1     1     0     1     1       4
Fixed duty      2     0     1     0     1       4
[Appointments]  1     2     1     0     1       5
[Course]        0     1     1     0     2       4
[cadre]         0     1     1     0     2       4
---------------------------------------------------
Total           4     5     3     3     6      21


Data Source Tables
==================

| Table                | Purpose                                                               |
| -------------------- | --------------------------------------------------------------------- |
| `duties`             | Base duty list including excusal rules (excused_next_day_games, etc.) |
| `duty_rank`          | Duty assignments linked to soldier and rank                           |
| `soldier_duties`     | Tracks daily duty assignment per soldier                              |
| `soldier_services`   | Holds soldier appointments                                            |
| `soldier_courses`    | Holds active courses                                                  |
| `soldier_cadres`     | Holds cadre participation records                                     |
| `ranks`              | List of military ranks                                                |
| `companies`          | List of companies (A–E)                                               |
| `soldiers` (implied) | Core soldier data including company and rank_id                       |


Business Rules
Rule Group 1: Excusal Logic (Games Attendance Exclusion)

A soldier is excluded (excused) from Games if any of the following is true:

#	Condition	Description
1	Has an active duty on that date	Soldier assigned to a duty (soldier_duties) for the date
2	Has a fixed duty	Exists in duty_rank with assignment_type = 'fixed'
3	Has active course	Exists in soldier_courses where status = 'active' and date is within range
4	Has active cadre	Exists in soldier_cadres where status = 'active' and date is within range
5	Has active appointment	Exists in soldier_services where status = 'active' and date is within range
6	Is on approved leave	Exists in soldier_leaves (if applicable) where current date within leave range and status is approved
7	Completed duty with next-day excusal	Soldier’s duty yesterday had excused_next_day_games = true in duties table

✅ If any one of these conditions apply → soldier is excused from Game attendance.
